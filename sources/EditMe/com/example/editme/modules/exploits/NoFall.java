package com.example.editme.modules.exploits;

import com.example.editme.modules.Module;
import net.minecraft.network.play.client.CPacketConfirmTeleport;
import net.minecraft.network.play.client.CPacketPlayer.Position;
import net.minecraft.network.play.client.CPacketPlayer.PositionRotation;

@Module.Info(
   name = "NoFall",
   category = Module.Category.HIDDEN
)
public class NoFall extends Module {
   NoFall.FallTimer timer = new NoFall.FallTimer(this);

   public void onUpdate() {
      this.timer.setCurrentMS();
      if (!mc.func_71356_B()) {
         if (mc.field_71439_g.field_70143_R > 4.0F && this.timer.hasDelayRun(800L)) {
            Position var1 = new Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u - 420.69D, mc.field_71439_g.field_70161_v, mc.field_71439_g.field_70122_E);
            mc.field_71439_g.field_71174_a.func_147297_a(var1);
            mc.field_71439_g.field_71174_a.func_147297_a(new CPacketConfirmTeleport());
            mc.field_71439_g.field_71174_a.func_147297_a(new PositionRotation(mc.field_71439_g.field_70165_t + mc.field_71439_g.field_70159_w, mc.field_71439_g.field_70163_u + 0.0622D, mc.field_71439_g.field_70161_v + mc.field_71439_g.field_70179_y, mc.field_71439_g.field_70177_z, mc.field_71439_g.field_70125_A, false));
            mc.field_71439_g.field_71174_a.func_147297_a(new PositionRotation(mc.field_71439_g.field_70165_t + mc.field_71439_g.field_70159_w, mc.field_71439_g.field_70163_u - 420.69D, mc.field_71439_g.field_70161_v + mc.field_71439_g.field_70179_y, mc.field_71439_g.field_70177_z, mc.field_71439_g.field_70125_A, true));
            this.timer.setLastMS();
         }

      }
   }

   private class FallTimer {
      private long lastMS;
      private long currentMS;
      final NoFall this$0;

      public void setLastMS() {
         this.lastMS = System.nanoTime() / 1000000L;
      }

      public boolean hasDelayRun(long var1) {
         return this.currentMS - this.lastMS >= var1;
      }

      public void setCurrentMS() {
         this.currentMS = System.nanoTime() / 1000000L;
      }

      private FallTimer(NoFall var1) {
         this.this$0 = var1;
         this.currentMS = 0L;
         this.lastMS = -1L;
      }

      FallTimer(NoFall var1, Object var2) {
         this(var1);
      }

      public void reset() {
         this.currentMS = System.nanoTime() / 1000000L;
      }
   }
}
