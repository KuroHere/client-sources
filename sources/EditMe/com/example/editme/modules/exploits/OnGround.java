package com.example.editme.modules.exploits;

import com.example.editme.events.EventPlayerUpdate;
import com.example.editme.modules.Module;
import com.example.editme.settings.Setting;
import com.example.editme.util.setting.SettingsManager;
import java.util.function.Predicate;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.client.entity.EntityPlayerSP;
import net.minecraft.network.play.client.CPacketPlayer.Position;
import net.minecraft.util.math.MathHelper;

@Module.Info(
   name = "OnGround",
   category = Module.Category.EXPLOITS
)
public class OnGround extends Module {
   @EventHandler
   private Listener OnPlayerUpdate = new Listener(this::lambda$new$0, new Predicate[0]);
   private Setting speed = this.register(SettingsManager.doubleBuilder("Speed").withMinimum(0.1D).withMaximum(1.0D).withValue((Number)0.2D).build());

   private float getRotationYaw() {
      float var1 = mc.field_71439_g.field_70177_z;
      if (mc.field_71439_g.field_191988_bg < 0.0F) {
         var1 += 180.0F;
      }

      float var2 = 1.0F;
      if (mc.field_71439_g.field_191988_bg < 0.0F) {
         var2 = -0.5F;
      } else if (mc.field_71439_g.field_191988_bg > 0.0F) {
         var2 = 0.5F;
      }

      if (mc.field_71439_g.field_70702_br > 0.0F) {
         var1 -= 90.0F * var2;
      }

      if (mc.field_71439_g.field_70702_br < 0.0F) {
         var1 += 90.0F * var2;
      }

      return var1 * 0.017453292F;
   }

   private void lambda$new$0(EventPlayerUpdate var1) {
      if ((mc.field_71439_g.field_191988_bg != 0.0F || mc.field_71439_g.field_70702_br != 0.0F) && mc.field_71439_g.field_70122_E) {
         float var2 = this.getRotationYaw();
         EntityPlayerSP var10000 = mc.field_71439_g;
         var10000.field_70159_w -= (double)MathHelper.func_76126_a(var2) * (Double)this.speed.getValue();
         var10000 = mc.field_71439_g;
         var10000.field_70179_y += (double)MathHelper.func_76134_b(var2) * (Double)this.speed.getValue();
         mc.field_71439_g.field_71174_a.func_147297_a(new Position(mc.field_71439_g.field_70165_t, mc.field_71439_g.field_70163_u + 0.4D, mc.field_71439_g.field_70161_v, false));
      }

   }
}
