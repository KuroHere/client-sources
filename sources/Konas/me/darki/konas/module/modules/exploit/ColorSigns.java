package me.darki.konas.module.modules.exploit;

import cookiedragon.eventsystem.Subscriber;
import me.darki.konas.event.events.PacketEvent;
import me.darki.konas.mixin.mixins.ICPacketUpdateSign;
import me.darki.konas.module.Module;
import me.darki.konas.setting.Setting;
import net.minecraft.network.play.client.CPacketUpdateSign;

public class ColorSigns extends Module {
    private Setting<Mode> mode = new Setting<>("Mode", Mode.VANILLA);

    private enum Mode {
        VANILLA, SPIGOT
    }

    public ColorSigns() {
        super("ColorSigns", "Lets you use color codes on signs", 0xFF91ED04, Category.EXPLOIT);
    }

    @Subscriber
    public void onPacketSend(PacketEvent.Send event) {
        if (event.getPacket() instanceof CPacketUpdateSign) {
            if (mc.getCurrentServerData() != null) {
                int i = 0;
                while (i < 4) {
                    if (((ICPacketUpdateSign) event.getPacket()).getLines()[i] != null) {
                        switch (mode.getValue()) {
                            case VANILLA: {
                                ((ICPacketUpdateSign) event.getPacket()).getLines()[i] = ((ICPacketUpdateSign) event.getPacket()).getLines()[i].replace("&", "\u00a7\u00a70");
                                break;
                            } case SPIGOT: {
                                ((ICPacketUpdateSign) event.getPacket()).getLines()[i] = ((ICPacketUpdateSign) event.getPacket()).getLines()[i].replace("&", "\u00a7\u00a7\u00a700");
                                break;
                            }
                        }
                    }
                    i++;
                }
            }
        }
    }
}
